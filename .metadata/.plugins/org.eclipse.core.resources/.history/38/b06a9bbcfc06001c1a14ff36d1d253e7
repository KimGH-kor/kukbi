package ch07.ATM;

import java.util.Scanner;

public class ATM {
	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);

		int num = 0;
		Peple[] arr = new Peple[100];
		boolean bq = true;
		boolean bw = false;
		int mone;
		String card;
		while (bq) {
			System.out.println("사용하실 서비스를 선택해 주십시오");
			System.out.println("1.카드 생성 2.계좌 리스트 확인 3.로그인 4.종료");
			int x = sc.nextInt();
			switch (x) {
			case 1:
				arr[num] = new Peple();
				System.out.println("계좌번호를 입력해 주세요 ex(1234-1234)");
				arr[num].setCard(sc.next());
				System.out.println("비밀번호 4자리를 입력해 주세요");
				arr[num].setPass(sc.next());
				System.out.println("이름을 입력해 주세요");
				arr[num].setName(sc.next());
				System.out.println("처음 입금하실 금액을 넣어주세요");
				arr[num].setMoney(sc.nextInt());

				System.out.println(arr[num].getCard() + "계좌가 생성되었습니다.");
				num++;
				break;
				
			case 2:
				try {
				System.out.println("현재 계좌 리스트는");
				for(int i = 0; i < num; i++) {
					System.out.println(arr[i].getCard()+"/"+arr[i].getName());
				}
				System.out.println("입니다");
				}catch (Exception e) {
				System.out.println("현재 생성된 계좌는 0개입니다.");
			}
				break;
			case 3:
				try {
				int count = 0;
				System.out.println("사용하실 계좌 번호를 입력해 주세요");
				String st = sc.next();
				//계좌 있는지 확인 하고 있으면 실행 되도록
				for(int i = 0; i < num; i++) {
					if(arr[i].getCard().equals(st)) {
						bw = true;
						count = i;
						break;
					}
				}
				if(bw == false) {
					System.out.println("잘못된 계좌입니다.");
				}else {
					while(bw) {
						int count2 = -1;
						System.out.println("원하는 서비스를 입력해 주세요");
						System.out.println("1.입금 2.출금 3.송금 4.현재 계좌 조회 5.로그아웃");
						x = sc.nextInt();
						switch (x) {
						case 1:
							System.out.println("입금하실 금액을 입력해 주세요");
							mone = sc.nextInt();
							arr[count].setMoney(arr[count].getMoney()+mone);	
							break;
						case 2:
							System.out.println("출금하실 금액을 입력해 주세요");
							mone = sc.nextInt();
							System.out.println("비밀번호를 입력해 주세요");
							if(arr[count].getPass().equals(sc.next())) {
							if(mone < arr[count].getMoney()) {
								arr[count].setMoney(arr[count].getMoney()-mone);
							}else {
								System.out.println("잔액이 부족합니다.");
							}
							}else {
								System.out.println("비밀번호가 다릅니다.");
							}
							break;
						case 3:
							System.out.println("송금하실 계좌 번호를 눌러주세요");
							card = sc.next();
							for(int i = 0; i < num; i++) {
								if(arr[i].equals(card)) {
									count2 = i;
									break;
								}
							}
							if(count2 == -1) {
								System.out.println("없는 계좌입니다. 다시 입력해 주세요");
							}else {
								System.out.println("비밀 번호를 입력해 주세요");
								if(arr[count].getPass().equals(sc.next())) {
								System.out.println("입금하실 금액을 입력해 주세요");
								mone = sc.nextInt();
								if(arr[count].getMoney() > mone) {
									arr[count].setMoney(arr[count].getMoney()-mone);
									arr[count2].setMoney(arr[count2].getMoney()+mone);
								}else {
									System.out.println("잔고가 부족합니다.");
								}
								}else {
									System.out.println("비밀 번호가 다릅니다.");
								}
							}
							break;
						case 4:
							System.out.println("비밀번호를 입력해 주세요");
							
							if(arr[count].getPass().equals(sc.next())) {
								System.out.println("현재 계좌의 잔고는 "+arr[count].getMoney()+"입니다.");
							}else {
								System.out.println("비밀번호가 다릅니다.");
							}
							break;
						case 5:
							bw = false;
							break;

						default:
							System.out.println("잘못된 번호입니다.");
							break;
						}
						}
					}
				}catch (Exception e) {
					System.out.println("현재 생성된 계좌는 0개입니다.");
				}
				break;
			case 4:
				System.out.println("이용해 주셔서 감사합니다.");
				bq = false;
				break;

			default:
				System.out.println("잘못된 번호입니다.");
				break;
			}
		}
	}
}
